---
title: "Result"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Fitting Analysis
```{r}
param_estimate = read_csv("parameter_estimate.csv")

# Output table
fit_result = 
  param_estimate %>% 
    mutate(
      notnull = ifelse(type == "null", 0, 1),
      notnull_est = ifelse(abs(estimate) > 0, 1, 0),
      identify =
        case_when(
          notnull == 1 & notnull_est == 1 ~ "TP",
          notnull == 1 & notnull_est == 0 ~ "FN",
          notnull == 0 & notnull_est == 1 ~ "FP",
          notnull == 0 & notnull_est == 0 ~ "TN"
        )
    ) %>% 
    group_by(sim_time, n, p, method) %>% 
    summarize(
      sensitivity = sum(identify == "TP")/(sum(identify == "TP") + sum(identify == "FN")),
      specificity = sum(identify == "TN")/(sum(identify == "TN") + sum(identify == "FP")),
      precision = sum(identify == "TP")/(sum(identify == "TP") + sum(identify == "FP")),
      accuracy = (sum(identify == "TP") + sum(identify == "TN"))/(sum(identify == "TP") + sum(identify == "FP") + sum(identify == "TN") + sum(identify == "FN")),
      number = sum(identify == "TP") + sum(identify == "FP") + sum(identify == "TN") + sum(identify == "FN"),
      F1_score = 2 * precision * sensitivity / (precision + sensitivity)
    )
```

# Visualization
```{r}
# compare sensitivity
ggplot(fit_result[1:100,], aes(x = method, y = sensitivity, color = method)) + 
  geom_boxplot() +
  theme(legend.position = "right") +
  labs(title = "Plot of length  per dose",x = "method", y = "F1_score")

# compare specificity
ggplot(fit_result[1:100,], aes(x = method, y = specificity, color = method)) + 
  geom_boxplot() +
  theme(legend.position = "right") +
  labs(title = "Plot of length  per dose",x = "method", y = "F1_score")

# compare f1 score
ggplot(fit_result[1:100,], aes(x = method, y = F1_score, color = method)) + 
  geom_boxplot() +
  theme(legend.position = "right") +
  labs(title = "Plot of length  per dose",x = "method", y = "F1_score")


```

